<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Nosto Autocomplete</title>
    <link rel="stylesheet" href="global.css">

    <!-- Include default nosto code -->
    <script>
      (function() {
        var name="nostojs";
        window[name]=window[name]||function(cb){(window[name].q=window[name].q||[]).push(cb);};
       })();
    </script>
    <!-- Include demo merchant with ability to run it locally -->
    <script src="https://connect.nosto.com/include/shopify-9758212174" async onload="window.nosto.reload({site: location.hostname, searchEnabled: false })"></script>
    <script src="../../dist/nosto-autocomplete.umd.js" async onload="initAutocomplete()"></script>

    <link rel="stylesheet" href="autocomplete.css">
    <script>
      window.initAutocomplete = function () {
        window.nostoAutocomplete.autocomplete({
          query: {
            products: {
              fields: ['name', 'url', 'imageUrl'],
              size: 5
            },
            keywords: {
              size: 5
            }
          },
          inputSelector: '#search',
          dropdownSelector: '#search-results',
          render: function (container, state) {
            var response = state.response

            container.innerHTML = ''

            if (response.keywords && response.keywords.hits.length > 0) {
              container.innerHTML += [
                '<div class="ns-autocomplete-header">',
                  'Keywords',
                '</div>',
                response.keywords.hits.map(function (hit) {
                  return [
                    '<div class="ns-autocomplete-keyword" data-ns-hit="' + JSON.stringify(hit) + '">',
                      '<span>' + hit.keyword + '</span>',
                    '</div>'
                  ].join('')
                }).join('')
              ].join('')
            }

            if (response.products && response.products.hits.length > 0) {
              container.innerHTML += [
                '<div class="ns-autocomplete-header">',
                  'Products',
                '</div>',
                response.products.hits.map(function (hit) {
                  return [
                    '<a href="' + hit.url + '" data-ns-hit="' + JSON.stringify(hit) + '">',
                      hit.name,
                    '</a>'
                  ].join('')
                }).join('')
              ].join('')
            }
          }
        })
      }
    </script>
</head>

  <body>
    <form id="search-form">
      <input type="text" id="search" placeholder="search" />
      <button type="submit" id="search-button">Search</button>
      <div id="search-results" class="ns-autocomplete"></div>
    </form>
  </body>
</html>
